@model List<Book>
@{
    
    Layout = "_AdminLayout";
    ViewData["Title"] = "Book Collection";
    
    // Pagination dummy data
    var currentPage = 1;
    var totalPages = 4;
    var totalItems = 24;
    var startItem = 1;
    var endItem = 6;
}

<div class="page-header">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-lg-6">
                <h1><i class="bi bi-book me-2"></i>Book Management</h1>
            </div>
            <div class="col-lg-6">
                <div class="d-flex justify-content-lg-end justify-content-start mt-4 mt-lg-0">
                    <div class="search-container me-3">
                        <i class="bi bi-search search-icon"></i>
                        <input type="text" id="searchInput" class="form-control" placeholder="Search books...">
                    </div>
                    <a asp-action="Create" asp-controller="AdminBook" class="btn btn-light add-book-btn">
                        <i class="bi bi-plus-lg me-2"></i>Add Book
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="container">
    <div class="table-container">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h2 class="mb-0 h4">Book Collection</h2>
            <div class="dropdown">
                <button class="btn btn-outline-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown">
                    Filter by Genre
                </button>
                <ul class="dropdown-menu">
                    <li><a class="dropdown-item" href="#" data-genre="">All Genres</a></li>
                    <li><a class="dropdown-item" href="#" data-genre="Fiction">Fiction</a></li>
                    <li><a class="dropdown-item" href="#" data-genre="Mystery">Mystery</a></li>
                    <li><a class="dropdown-item" href="#" data-genre="Fantasy">Fantasy</a></li>
                    <li><a class="dropdown-item" href="#" data-genre="Romance">Romance</a></li>
                    <li><a class="dropdown-item" href="#" data-genre="SciFi">Sci-Fi</a></li>
                </ul>
            </div>
        </div>

        <div class="table-responsive">
            <table class="table" id="booksTable">
                <thead>
                    <tr>
                        <th>Title</th>
                        <th>Author</th>
                        <th>Genre</th>
                        <th>Price</th>
                        <th style="width: 180px;">Actions</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var book in Model)
                    {
                        <tr>
                            <td>@book.Title</td>
                            <td>@book.Author</td>
                            <td>
                                @{
                                    string badgeClass = book.Genre switch
                                    {
                                        "Fiction" => "genre-badge-fiction",
                                        "Mystery" => "genre-badge-mystery",
                                        "Fantasy" => "genre-badge-fantasy",
                                        "Romance" => "genre-badge-romance",
                                        "SciFi" => "genre-badge-scifi",
                                        _ => "bg-secondary"
                                    };
                                }
                                <span class="badge @badgeClass">@book.Genre</span>
                            </td>
                            <td>@string.Format("${0:N2}", book.Price)</td>
                            <td>
                                <div class="action-buttons">
                                    <a asp-action="Details" asp-controller="AdminBook" asp-route-id="@book.Id"
                                       class="btn btn-primary action-btn btn-details" data-bs-toggle="tooltip" title="View Details">
                                        <i class="bi bi-eye-fill"></i>
                                    </a>
                                    <a asp-action="Edit" asp-controller="AdminBook" asp-route-id="@book.Id"
                                       class="btn btn-success action-btn btn-update" data-bs-toggle="tooltip" title="Edit Book">
                                        <i class="bi bi-pencil-fill"></i>
                                    </a>

                                </div>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>

        <div class="d-flex justify-content-between align-items-center mt-4">
            <div>
                <p class="text-muted mb-0">Showing @startItem-@endItem of @totalItems books</p>
            </div>
            <nav>
                <ul class="pagination mb-0">
                    <li class="page-item @(currentPage == 1 ? "disabled" : "")">
                        <a class="page-link" asp-action="Index" asp-route-page="@(currentPage - 1)" aria-label="Previous">
                            <i class="bi bi-chevron-left"></i>
                        </a>
                    </li>
                    @for (int i = 1; i <= totalPages; i++)
                    {
                        <li class="page-item @(i == currentPage ? "active" : "")">
                            <a class="page-link" asp-action="Index" asp-route-page="@i">@i</a>
                        </li>
                    }
                    <li class="page-item @(currentPage == totalPages ? "disabled" : "")">
                        <a class="page-link" asp-action="Index" asp-route-page="@(currentPage + 1)" aria-label="Next">
                            <i class="bi bi-chevron-right"></i>
                        </a>
                    </li>
                </ul>
            </nav>
        </div>
    </div>
</div>

<!-- Delete Confirmation Modal -->
<div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title text-center" id="deleteModalLabel">Confirm Deletion</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>Are you sure you want to delete this book ?</p>
                <span class="fw-bold fs-4" id="bookTitle"></span>
                <span class="fw-light fst-italic" id="bookAuthor">by Authorname</span>
                
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <form id="deleteForm" asp-action="DeleteConfirmed" asp-controller="AdminBook" method="post">
                    <input type="hidden" id="bookIdInput" name="id" />
                    @Html.AntiForgeryToken()
                    <button type="submit" class="btn btn-danger">Delete</button>
                </form>
            </div>
        </div>
    </div>
</div>

@section Styles {
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.10.5/font/bootstrap-icons.min.css">
    <style>
        body {
            background-color: #f8f9fa;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .page-header {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            color: white;
            border-radius: 0 0 20px 20px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
            padding: 2rem 0;
        }

        .table-container {
            background: white;
            border-radius: 15px;
            box-shadow: 0 0 25px rgba(0, 0, 0, 0.05);
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        .table {
            border-collapse: separate;
            border-spacing: 0;
        }

            .table thead {
                background-color: #f8f9fa;
            }

                .table thead th {
                    border-bottom: 2px solid #dee2e6;
                    font-weight: 600;
                    color: #495057;
                    padding: 1rem;
                }

            .table tbody tr {
                transition: background-color 0.2s;
            }

                .table tbody tr:hover {
                    background-color: rgba(37, 117, 252, 0.05);
                }

            .table tbody td {
                padding: 1rem;
                vertical-align: middle;
                border-bottom: 1px solid #e9ecef;
            }

        .badge {
            font-weight: 500;
            padding: 0.5em 0.75em;
        }

        .action-buttons {
            display: flex;
            gap: 6px;
        }

        .action-btn {
            width: 38px;
            height: 38px;
            padding: 0;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

            .action-btn::before {
                content: '';
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(255, 255, 255, 0.15);
                transform: scale(0);
                transition: transform 0.3s ease;
                border-radius: 50%;
            }

            .action-btn:hover::before {
                transform: scale(2);
            }

            .action-btn:hover {
                transform: translateY(-2px);
                box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            }

        .btn-details {
            background: linear-gradient(45deg, #6a11cb, #8e44ad);
            border-color: #6a11cb;
        }

            .btn-details:hover {
                background: linear-gradient(45deg, #5809af, #7d3c98);
                border-color: #5809af;
            }

        .btn-update {
            background: linear-gradient(45deg, #2575fc, #4a96ff);
            border-color: #2575fc;
        }

            .btn-update:hover {
                background: linear-gradient(45deg, #1a65e3, #3d8bff);
                border-color: #1a65e3;
            }

        .btn-delete {
            background: linear-gradient(45deg, #e53935, #ff5252);
            border-color: #e53935;
        }

            .btn-delete:hover {
                background: linear-gradient(45deg, #d32f2f, #ff1744);
                border-color: #d32f2f;
            }

        .search-container {
            position: relative;
            max-width: 400px;
        }

            .search-container .form-control {
                border-radius: 50px;
                padding-left: 45px;
                padding-right: 20px;
                height: 50px;
                box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            }

            .search-container .search-icon {
                position: absolute;
                left: 18px;
                top: 50%;
                transform: translateY(-50%);
                color: #6c757d;
            }

        .add-book-btn {
            border-radius: 50px;
            padding: 0.75rem 1.5rem;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(37, 117, 252, 0.2);
            transition: all 0.3s;
            background: white;
            color: #2575fc;
        }

            .add-book-btn:hover {
                transform: translateY(-3px);
                box-shadow: 0 6px 18px rgba(37, 117, 252, 0.25);
                background: #f8f9fa;
            }

        .pagination {
            justify-content: center;
        }

        .page-item:not(:first-child) .page-link {
            margin-left: 5px;
        }

        .page-link {
            border-radius: 8px;
            color: #2575fc;
            padding: 0.5rem 0.85rem;
        }

        .page-item.active .page-link {
            background-color: #2575fc;
            border-color: #2575fc;
        }

        .genre-badge-fiction {
            background-color: #6a11cb;
        }

        .genre-badge-mystery {
            background-color: #2575fc;
        }

        .genre-badge-fantasy {
            background-color: #fd7e14;
        }

        .genre-badge-romance {
            background-color: #e83e8c;
        }

        .genre-badge-scifi {
            background-color: #20c997;
        }
    </style>
}

@section Scripts {
    <script>
        // Initialize tooltips
        document.addEventListener('DOMContentLoaded', function() {
            var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
            var tooltipList = tooltipTriggerList.map(function(tooltipTriggerEl) {
                return new bootstrap.Tooltip(tooltipTriggerEl);
            });

            // Handle delete modal
            var deleteModal = document.getElementById('deleteModal');
            if (deleteModal) {
                deleteModal.addEventListener('show.bs.modal', function(event) {
                    var button = event.relatedTarget;
                    var id = button.getAttribute('data-id');
                    var title = button.getAttribute('data-title');

                    document.getElementById('bookTitle').textContent = title;
                    document.getElementById('bookIdInput').value = id;
                });
            }

            // Search functionality
            var searchInput = document.getElementById('searchInput');
            if (searchInput) {
                searchInput.addEventListener('keyup', function() {
                    var filter = searchInput.value.toUpperCase();
                    var table = document.getElementById('booksTable');
                    var tr = table.getElementsByTagName('tr');

                    for (var i = 1; i < tr.length; i++) {
                        var titleCell = tr[i].getElementsByTagName('td')[0];
                        var authorCell = tr[i].getElementsByTagName('td')[1];

                        if (titleCell && authorCell) {
                            var titleValue = titleCell.textContent || titleCell.innerText;
                            var authorValue = authorCell.textContent || authorCell.innerText;

                            if (titleValue.toUpperCase().indexOf(filter) > -1 ||
                                authorValue.toUpperCase().indexOf(filter) > -1) {
                                tr[i].style.display = '';
                            } else {
                                tr[i].style.display = 'none';
                            }
                        }
                    }
                });
            }

            // Genre filtering
            var genreLinks = document.querySelectorAll('.dropdown-menu a[data-genre]');
            genreLinks.forEach(function(link) {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    var genre = this.getAttribute('data-genre').toUpperCase();
                    var table = document.getElementById('booksTable');
                    var tr = table.getElementsByTagName('tr');

                    for (var i = 1; i < tr.length; i++) {
                        var genreCell = tr[i].getElementsByTagName('td')[2];

                        if (genreCell) {
                            var genreValue = genreCell.textContent || genreCell.innerText;

                            if (genre === '' || genreValue.toUpperCase().indexOf(genre) > -1) {
                                tr[i].style.display = '';
                            } else {
                                tr[i].style.display = 'none';
                            }
                        }
                    }
                });
            });
        });
    </script>
}